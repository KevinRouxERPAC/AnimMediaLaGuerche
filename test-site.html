<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Site Anim'M√©dia</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .info { background: #d1ecf1; border-color: #bee5eb; }
    </style>
</head>
<body>
    <h1>üß™ Tests de Fonctionnement - Site Anim'M√©dia</h1>
    
    <div id="results"></div>
    
    <script>
        // Fonction pour ajouter un r√©sultat de test
        function addTestResult(name, status, message) {
            const resultsDiv = document.getElementById('results');
            const testDiv = document.createElement('div');
            testDiv.className = `test ${status}`;
            testDiv.innerHTML = `
                <strong>${status === 'success' ? '‚úÖ' : status === 'error' ? '‚ùå' : '‚ÑπÔ∏è'} ${name}</strong><br>
                ${message}
            `;
            resultsDiv.appendChild(testDiv);
        }
        
        // Tests des URLs principales
        async function testUrls() {
            const urls = [
                { name: 'Site principal', url: 'https://kevinrouxerpac.github.io/AnimMediaLaGuerche/' },
                { name: 'Manifest PWA', url: 'https://kevinrouxerpac.github.io/AnimMediaLaGuerche/manifest.json' },
                { name: 'Sitemap XML', url: 'https://kevinrouxerpac.github.io/AnimMediaLaGuerche/sitemap.xml' },
                { name: 'Robots.txt', url: 'https://kevinrouxerpac.github.io/AnimMediaLaGuerche/robots.txt' }
            ];
            
            for (const test of urls) {
                try {
                    const response = await fetch(test.url, { method: 'HEAD' });
                    if (response.ok) {
                        addTestResult(test.name, 'success', `Accessible (Status: ${response.status})`);
                    } else {
                        addTestResult(test.name, 'error', `Erreur HTTP ${response.status}`);
                    }
                } catch (error) {
                    addTestResult(test.name, 'error', `Erreur de connexion: ${error.message}`);
                }
            }
        }
        
        // Test des fonctionnalit√©s JavaScript dans une iframe
        function testJavaScriptFeatures() {
            addTestResult('Test JavaScript', 'info', 'Cr√©ation d\'une iframe pour tester les fonctionnalit√©s...');
            
            const iframe = document.createElement('iframe');
            iframe.src = 'https://kevinrouxerpac.github.io/AnimMediaLaGuerche/';
            iframe.style.width = '1px';
            iframe.style.height = '1px';
            iframe.style.opacity = '0';
            iframe.style.position = 'absolute';
            iframe.style.top = '-1000px';
            
            iframe.onload = function() {
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    
                    // Test des √©l√©ments critiques
                    const tests = [
                        { name: 'Menu navigation', selector: '.navbar', expected: true },
                        { name: 'Bouton Admin', selector: '#admin-toggle', expected: true },
                        { name: 'Section Activit√©s', selector: '#activites', expected: true },
                        { name: 'Section √âv√©nements', selector: '#evenements', expected: true },
                        { name: 'Galerie', selector: '#galerie .gallery-grid', expected: true },
                        { name: 'Footer', selector: 'footer', expected: true }
                    ];
                    
                    tests.forEach(test => {
                        const element = iframeDoc.querySelector(test.selector);
                        if (element && test.expected) {
                            addTestResult(test.name, 'success', '√âl√©ment trouv√© et correctement affich√©');
                        } else {
                            addTestResult(test.name, 'error', '√âl√©ment non trouv√©');
                        }
                    });
                    
                    // Test des scripts
                    const scripts = iframeDoc.querySelectorAll('script[src]');
                    let jsFilesFound = 0;
                    scripts.forEach(script => {
                        if (script.src.includes('script.js') || script.src.includes('advanced-features.js')) {
                            jsFilesFound++;
                        }
                    });
                    
                    if (jsFilesFound >= 2) {
                        addTestResult('Scripts JavaScript', 'success', `${jsFilesFound} fichiers JS charg√©s`);
                    } else {
                        addTestResult('Scripts JavaScript', 'error', `Seulement ${jsFilesFound} fichier(s) JS trouv√©(s)`);
                    }
                    
                } catch (error) {
                    addTestResult('Test JavaScript', 'error', `Erreur d'acc√®s √† l'iframe: ${error.message}`);
                }
                
                // Nettoyage
                setTimeout(() => {
                    document.body.removeChild(iframe);
                }, 1000);
            };
            
            iframe.onerror = function() {
                addTestResult('Test JavaScript', 'error', 'Impossible de charger le site dans l\'iframe');
                document.body.removeChild(iframe);
            };
            
            document.body.appendChild(iframe);
        }
        
        // Test de performance basique
        async function testPerformance() {
            const startTime = performance.now();
            try {
                const response = await fetch('https://kevinrouxerpac.github.io/AnimMediaLaGuerche/');
                const endTime = performance.now();
                const loadTime = Math.round(endTime - startTime);
                
                if (loadTime < 3000) {
                    addTestResult('Performance', 'success', `Temps de chargement: ${loadTime}ms (Excellent)`);
                } else if (loadTime < 5000) {
                    addTestResult('Performance', 'info', `Temps de chargement: ${loadTime}ms (Correct)`);
                } else {
                    addTestResult('Performance', 'error', `Temps de chargement: ${loadTime}ms (Lent)`);
                }
            } catch (error) {
                addTestResult('Performance', 'error', `Erreur de test: ${error.message}`);
            }
        }
        
        // Ex√©cution des tests
        async function runAllTests() {
            addTestResult('D√©but des tests', 'info', 'Lancement de la batterie de tests...');
            
            await testUrls();
            await testPerformance();
            testJavaScriptFeatures();
            
            setTimeout(() => {
                addTestResult('Tests termin√©s', 'info', 'Tous les tests ont √©t√© ex√©cut√©s. V√©rifiez les r√©sultats ci-dessus.');
            }, 2000);
        }
        
        // Lancer les tests au chargement de la page
        document.addEventListener('DOMContentLoaded', runAllTests);
    </script>
</body>
</html>
